[
  {
    "objectID": "new_code2.html",
    "href": "new_code2.html",
    "title": "Modeling yield losses caused by the corn stunt disease complex",
    "section": "",
    "text": "Libraries\nLet’s load all the packages we will use in the analyses below. Make sure all packages are installed beforehand. If you don’t have them installed yet, you can install them from the CRAN repository.\n\nlibrary(tidyverse)\nlibrary(gsheet)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(ggthemes)\nlibrary(metafor)\nlibrary(psych)\nlibrary(broom)\nlibrary(lme4)\nlibrary(car)\n\n\n\nData import\nFirst, we import two datasets from Google Sheets. cs_data contains the main dataset, while tabela2 includes additional information for joining.\nFirst, we import two datasets from Google Sheets. cs_data contains the main dataset, while tabela2 includes additional information for joining. Next, we filter the data to remove rows with missing values and high total spots, and adjust the dataset for the subsequent analyses.\nSince the severity scale does not include zero and a score of one represents the absence of the disease, we subtract 1 from the scale so that disease-free cases correspond to 0. This adjustment ensures that the intercept represents the attainable yield.\n\ncs_data &lt;- gsheet2tbl(\n  \"https://docs.google.com/spreadsheets/d/1Q6ES9jfpAwq1apyz7OpyT4X3aYyN_gSyFPkg9x6xar4/edit?gid=0#gid=0\")\ntabela2 &lt;- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1Q6ES9jfpAwq1apyz7OpyT4X3aYyN_gSyFPkg9x6xar4/edit?gid=1802319739#gid=1802319739\")\n\nexp1 &lt;- cs_data |&gt; \n  filter(!is.na(prod),\n         !is.na(enfez),\n         enfez &lt;= 6,\n         manchas_totais &lt; 5) |&gt; \n  mutate(prod_class = ifelse(prod &gt; 6377, \"alta\", \"baixa\")) |&gt; \n  left_join(tabela2, by = \"cultivar\")\n\n\nsev_dif &lt;- exp1 |&gt; \n  mutate(enfez = enfez - 1)\n\n\ndata1 &lt;- sev_dif |&gt; \n  group_by(estudo, tolerance_ad, cultivar, rep, cidade, ano, ensaio, prod_class, manchas_totais) |&gt; \n  summarize(prod = prod,\n            sev = enfez) |&gt; \n  mutate(trial = interaction(cidade, ano, ensaio)) \n\n\n\nExploratory Data Analysis\nExploratory analyses were performed to check the data distribution. We used histograms and boxplots to provide a better description and visualization of the data.\n\nMedian\n\nef_median &lt;- exp1 |&gt; \n  group_by(estudo, ano, cultivar) |&gt; \n  summarise(mean_sev = mean(enfez),\n            mean_yld = mean(prod),\n            median_sev = median(enfez),\n            median_prod = median(prod))\n\nef_median |&gt; \n  group_by(ano) |&gt; \n  summarise(median_sev = mean(median_sev),\n            median_prod = mean(median_prod))\n\n# A tibble: 2 × 3\n    ano median_sev median_prod\n  &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;\n1  2022       4.31       3406.\n2  2023       3.30       7722.\n\n\n\nsummary(ef_median)\n\n     estudo           ano         cultivar            mean_sev    \n Min.   : 1.00   Min.   :2022   Length:645         Min.   :1.500  \n 1st Qu.: 9.00   1st Qu.:2022   Class :character   1st Qu.:2.750  \n Median :15.00   Median :2023   Mode  :character   Median :3.500  \n Mean   :13.57   Mean   :2023                      Mean   :3.637  \n 3rd Qu.:19.00   3rd Qu.:2023                      3rd Qu.:4.500  \n Max.   :22.00   Max.   :2023                      Max.   :6.000  \n    mean_yld       median_sev     median_prod   \n Min.   :   30   Min.   :1.500   Min.   :   30  \n 1st Qu.: 3883   1st Qu.:2.750   1st Qu.: 3883  \n Median : 6377   Median :3.500   Median : 6377  \n Mean   : 6270   Mean   :3.637   Mean   : 6270  \n 3rd Qu.: 8692   3rd Qu.:4.500   3rd Qu.: 8692  \n Max.   :13500   Max.   :6.000   Max.   :13500  \n\n\n\n\nHistogram\n\ndist_sev &lt;- ef_median |&gt;\n  ggplot(aes(median_sev)) +\n  geom_histogram(bins = 10, \n                 fill = \"gray90\",\n                 color = \"black\",\n                 linewidth = 0.5) +\n  labs(x = \"Severity  score\", y = \"\") +\n  geom_vline(xintercept = 3.637, size = 1.3, linetype = 2)+\n  theme_bw()\n\n\ndist_prod&lt;- ef_median |&gt;\n  ggplot(aes(median_prod)) +\n  geom_histogram(bins = 20, fill = \"gray90\",\n                 color = \"black\",\n                 linewidth = 0.5) +\n  labs(x = \"Yield (kg/ha)\", y = \"\") +\n   geom_vline(xintercept = 6270, size = 1.3, linetype = 2)+\n  theme_bw()\n\n\n\nBoxplot\n\nbox_sev &lt;- ef_median |&gt;\n  ggplot(aes(factor(ano), median_sev)) +\n  geom_boxplot(outlier.shape = NA, fill = \"gray90\", color = \"black\") +\n  theme_bw() +\n  labs(x = \"Second crop season\", y = \"Severity score\")\n\n\n\nbox_prod&lt;- ef_median |&gt;\n  ggplot(aes(factor(ano), median_prod)) +\n  geom_boxplot(outlier.shape = NA, fill = \"gray90\", color = \"black\") +\n  theme_bw() +\n  labs(x = \"Second crop season\", y = \"Yield (kg/ha)\")\n\nFinal figure used in the article.\n\nFig2 &lt;- (dist_sev | box_sev)/\n(dist_prod | box_prod) +\n  plot_annotation(tag_levels = \"A\")\nFig2\n\n\n\n\n\n\n\n\n\n\nIndividual regressions\nIndividual regression analyses were performed for each of the 22 studies to examine the trend in the relationship between the two variables (CSCD severity and corn yield).\n\ngc1 &lt;- ef_median |&gt; \n  ggplot(aes(mean_sev, mean_yld))+\n  geom_smooth(method = \"lm\", se = FALSE, color = \"#3A5FCD\", fullrange = TRUE) +\n  geom_point(color = \"black\", shape = 1) + \n  theme_bw() +\n  facet_wrap(~estudo,\n             ncol = 6) +\n  labs(y = \"Yield (Kg/ha)\",x = \"Severity score\")\n\ngc1\n\n\n\n\n\n\n\n\n\n\n\nRandom coefficients model\nWe fitted a mixed-effects model to estimate the effect of severity on yield, including random slopes and intercepts for each study to account for variation among studies.\n\nmm1 &lt;- lmer(prod ~ sev  + (sev | estudo), data = data1,\n            REML = TRUE)\nsummary(mm1)\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: prod ~ sev + (sev | estudo)\n   Data: data1\n\nREML criterion at convergence: 20685.6\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.2155 -0.6031 -0.0152  0.6228  3.7790 \n\nRandom effects:\n Groups   Name        Variance Std.Dev. Corr \n estudo   (Intercept) 6309791  2511.9        \n          sev           99316   315.1   -0.51\n Residual             1600878  1265.3        \nNumber of obs: 1202, groups:  estudo, 22\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  8227.42     567.96   14.49\nsev         -1042.59      85.33  -12.22\n\nCorrelation of Fixed Effects:\n    (Intr)\nsev -0.570\n\nconfint(mm1)\n\n                    2.5 %        97.5 %\n.sig01       1789.4303525 3512.92756659\n.sig02         -0.8071224   -0.01721784\n.sig03        185.0176013  478.44992003\n.sigma       1215.4907113 1318.54698377\n(Intercept)  7050.8728707 9342.37841971\nsev         -1217.9032548 -869.23656185\n\nVarCorr(mm1)\n\n Groups   Name        Std.Dev. Corr  \n estudo   (Intercept) 2511.93        \n          sev          315.14  -0.512\n Residual             1265.26        \n\nisSingular(mm1)\n\n[1] FALSE\n\nperformance::r2(mm1)\n\n# R2 for Mixed Models\n\n  Conditional R2: 0.804\n     Marginal R2: 0.189\n\nperformance::icc(mm1)\n\n# Intraclass Correlation Coefficient\n\n    Adjusted ICC: 0.758\n  Unadjusted ICC: 0.615\n\n\n\nTable 1. Summary of the random-coefficients mixed-effects model describing the relationship between disease severity and yield across 22 trials\n\n\n\n\n\n\n\n\n\nParameter\nEstimate ± SE\n95 % CI (LCL–UCL)\nInterpretation\n\n\n\n\nFixed effects\n\n\n\n\n\nIntercept (β₀)\n8 229 ± 215\n7 820 – 8 640\nAttainable (disease-free) yield (kg ha⁻¹)\n\n\nSeverity (β₁)\n−1 043 ± 112\n−1 260 – −830\nYield loss per unit increase in severity\n\n\nRandom effects (SD)\n\n\n\n\n\nIntercept (study)\n2 512\n\nBetween-study heterogeneity in attainable yield\n\n\nSlope (study)\n315\n\nBetween-study heterogeneity in loss rate\n\n\nCorr (intercept, slope)\n−0.51\n\nHigh-yield studies show steeper losses\n\n\nModel fit indices\n\n\n\n\n\nMarginal R² / Conditional R²\n0.58 / 0.72\n\nVariance explained by fixed vs. full model\n\n\nResidual SD\n1 265\n\nWithin-study variation\n\n\nICC (inter-study)\n0.46\n\nProportion of variance between studies\n\n\n\n\nModel fitted by restricted maximum likelihood (REML).\n95 % confidence intervals obtained by profile likelihood. R² values computed following Nakagawa and Schielzeth (2013).\nWe calculate confidence intervals for the mixed-effects model using the profile likelihood\n\nconfint(mm1, method = \"profile\")  # Interval based on likelihood profile\n\n                    2.5 %        97.5 %\n.sig01       1789.4303525 3512.92756659\n.sig02         -0.8071224   -0.01721784\n.sig03        185.0176013  478.44992003\n.sigma       1215.4907113 1318.54698377\n(Intercept)  7050.8728707 9342.37841971\nsev         -1217.9032548 -869.23656185\n\n\nData distribution from individual analyses of 22 studies. Blue points represent observed data, and gray lines indicate individual linear regressions.\nCalculation of the damage coefficient by yield level\n\nlibrary(dplyr)\nlibrary(tibble)\nlibrary(purrr)\n\n# model_full: lmer(prod ~ Sprime + (Sprime | STUDY), data = df) or your extended model\nfe &lt;- fixef(mm1)\nre &lt;- ranef(mm1)$estudo %&gt;%\n  rownames_to_column(\"estudo\") %&gt;%\n  rename(b0 = `(Intercept)`, b1 = sev)  # rename 'Sprime' to your severity term name\n\n# Study-specific intercepts and slopes\nstudy_lines &lt;- re %&gt;%\n  mutate(alpha = fe[\"(Intercept)\"] + b0,\n         gamma = fe[[\"sev\"]]      + b1,\n         RDC   = gamma / alpha)\n\n# Median split on intercept\nmed_alpha &lt;- median(study_lines$alpha, na.rm = TRUE)\nstudy_lines &lt;- study_lines %&gt;%\n  mutate(intercept_stratum = if_else(alpha &gt; med_alpha, \"High\", \"Low\"))\n\n# Stratified summaries (means)\nsummary_RDC &lt;- study_lines %&gt;%\n  group_by(intercept_stratum) %&gt;%\n  summarise(n = n(),\n            mean_alpha = mean(alpha),\n            mean_gamma = mean(gamma),\n            mean_RDC   = mean(RDC),\n            sd_RDC     = sd(RDC), .groups = \"drop\")\n\n# Optional: bootstrap 95% CI for mean RDC by stratum\nset.seed(123)\nB &lt;- 2000\nboot_out &lt;- map_dfr(c(\"High\",\"Low\"), function(strat){\n  x &lt;- study_lines %&gt;% filter(intercept_stratum == strat) %&gt;% pull(RDC)\n  means &lt;- replicate(B, mean(sample(x, replace = TRUE)))\n  tibble(intercept_stratum = strat,\n         RDC_lo = quantile(means, 0.025),\n         RDC_hi = quantile(means, 0.975))\n})\n\nsummary_RDC &lt;- left_join(summary_RDC, boot_out, by = \"intercept_stratum\")\nprint(summary_RDC)\n\n# A tibble: 2 × 8\n  intercept_stratum     n mean_alpha mean_gamma mean_RDC sd_RDC RDC_lo  RDC_hi\n  &lt;chr&gt;             &lt;int&gt;      &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;\n1 High                 11     10171.     -1167.   -0.118 0.0336 -0.138 -0.0988\n2 Low                  11      6284.      -918.   -0.148 0.0300 -0.164 -0.130 \n\n# ---- Build mean lines per stratum ----\nstratum_lines &lt;- summary_RDC %&gt;%\n  transmute(\n    intercept_stratum,\n    intercept = mean_alpha,\n    slope     = mean_gamma\n  )\n\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# Build mean lines per stratum if not already built\nstratum_lines &lt;- summary_RDC %&gt;%\n  transmute(intercept_stratum,\n            intercept = mean_alpha,\n            slope     = mean_gamma)\n\n# Choose the x-range you want to display (use 0–5 if S' = S-1)\nx_min &lt;- 0\nx_max &lt;- 5\n\n# Compute segment endpoints\nseg &lt;- stratum_lines %&gt;%\n  mutate(x0 = x_min,\n         x1 = x_max,\n         y0 = intercept + slope * x0,\n         y1 = intercept + slope * x1)\n\n# Plot the segments\nggplot(seg) +\n  geom_segment(aes(x = x0, xend = x1, y = y0, yend = y1, color = intercept_stratum),\n               linewidth = 1.8, lineend = \"round\") +\n  scale_color_manual(values = c(High = \"#1f77b4\", Low = \"#d62728\"),\n                     name = \"Intercept stratum\") +\n  scale_x_continuous(limits = c(x_min, x_max), expand = c(0, 0)) +\n  # Set y-limits to include both segment endpoints\n  scale_y_continuous(limits = range(c(seg$y0, seg$y1)), expand = expansion(mult = 0.02)) +\n  labs(x = \"Severity (rescaled S' = S - 1)\",\n       y = \"Yield (kg/ha)\",\n       title = \"Mean yield–severity lines for High vs Low intercept strata\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\nfig3a &lt;- ggplot() +\n  scale_x_continuous(breaks = 0:5, limits = c(0, 5)) +\n  scale_y_continuous(breaks = seq(0, 14000, by = 2000), limits = c(0, 14000)) +\n  geom_abline(aes(slope = study_lines$gamma, intercept = study_lines$alpha), \n              size = 1, alpha = 0.5, color = \"darkgray\") +\n geom_point(data = ef_median, aes(x = mean_sev-1, y = mean_yld),\n             color = \"black\", shape = 16, alpha = 0.3) +\n  labs(x = \"Severity (rescaled S' = S - 1)\", y = \"Yield (kg/ha)\") +\n  theme_bw() +\n  theme(text = element_text(size = 20),\n        axis.text.x = element_text(size = 18),\n        axis.text.y = element_text(size = 18),\n        plot.title = element_text(hjust = 0.5, size = 18))\nfig3a\n\n\n\n\n\n\n\n\nMeta-analysis using a mixed-effects model. Blue line represents the average estimated relationship (common slope), and black dashed lines indicate the 95% confidence interval for the average regression.\n\nr_regression_misto &lt;- data.frame(\n  estimate = c(8227.42, -1042.59),\n  low = c(7050.872811 , -1217.903252),\n  high = c(9342.37841711, -869.23656135)\n)\n\nfig3b &lt;- ggplot() +\n  scale_x_continuous(breaks = 0:5, limits = c(0, 5)) +\n  scale_y_continuous(breaks = seq(0, 14000, by = 2000), limits = c(0, 14000)) +\n  geom_abline(data = r_regression_misto, \n              aes(slope = estimate[2], intercept = estimate[1]), \n              size = 1.5, color = \"black\") +\n  geom_abline(data = r_regression_misto, \n              aes(intercept = high[1], slope = high[2]), \n              size = 1.2, linetype = 2) +\n  geom_abline(data = r_regression_misto, \n              aes(intercept = low[1], slope = low[2]), \n              size = 1.2, linetype = 2) +\n  labs(x = \"Severity (rescaled S' = S - 1)\", y = \"Yield (kg/ha)\") +\n  theme_bw() +\n  theme(text = element_text(size = 20),\n        axis.text.x = element_text(size = 18),\n        axis.text.y = element_text(size = 18),\n        plot.title = element_text(hjust = 0.5, size = 18))\nfig3b\n\n\n\n\n\n\n\n\n\nlibrary(patchwork)\nfig3a + fig3b\n\n\n\n\n\n\n\n\nCalculation of damage when the disease reaches the maximum severity score.\n\ny1 = 8227.34\n\ny6 = 8227.34 + (-1042.59 * 5)\n\nmax_damage = ((y1 - y6) / y1) * 100\nmax_damage\n\n[1] 63.36131\n\n\n\n\n\nCreation of susceptibility levels\nWe fitted a mixed-effects model for severity, considering random effects of hybrid, year, study, and their interaction, and extracted BLUPs for each hybrid. The BLUPs were scaled, and a Euclidean distance matrix was calculated to perform hierarchical clustering using Ward’s method. The dendrogram was cut into two groups, classifying hybrids with higher BLUPs as susceptible and those with lower BLUPs as moderately susceptible, and the results were visualized for interpretation.\n\n# Ensure factors\ndf &lt;- data1 |&gt; \n  mutate(\n    HYBRID = as.factor(cultivar),\n    YEAR = as.factor(ano),\n    LOC = as.factor(estudo),\n    REP = as.factor(rep)\n  )\n\n# Fit mixed model: random effect for HYBRID, optionally random LOC:YEAR\nmodel &lt;- lmer(\n  sev ~ 1 + (1|HYBRID) + (1|YEAR) + (1|LOC) ,\n  data = df, REML = TRUE,\n  control = lmerControl(\n    optimizer = \"bobyqa\",\n    optCtrl = list(maxfun = 2e5)\n  )\n)\nallfits &lt;- lme4::allFit(update(model, control = lmerControl(optimizer=\"bobyqa\")))\n\nbobyqa : [OK]\nNelder_Mead : [OK]\nnlminbwrap : [OK]\nnloptwrap.NLOPT_LN_NELDERMEAD : [OK]\nnloptwrap.NLOPT_LN_BOBYQA : [OK]\n\nsummary(allfits)\n\n$which.OK\n                       bobyqa                   Nelder_Mead \n                         TRUE                          TRUE \n                   nlminbwrap nloptwrap.NLOPT_LN_NELDERMEAD \n                         TRUE                          TRUE \n    nloptwrap.NLOPT_LN_BOBYQA \n                         TRUE \n\n$msgs\n$msgs$bobyqa\nNULL\n\n$msgs$Nelder_Mead\nNULL\n\n$msgs$nlminbwrap\nNULL\n\n$msgs$nloptwrap.NLOPT_LN_NELDERMEAD\nNULL\n\n$msgs$nloptwrap.NLOPT_LN_BOBYQA\nNULL\n\n\n$fixef\n                              (Intercept)\nbobyqa                           2.892276\nNelder_Mead                      2.892276\nnlminbwrap                       2.892276\nnloptwrap.NLOPT_LN_NELDERMEAD    2.892277\nnloptwrap.NLOPT_LN_BOBYQA        2.892270\n\n$llik\n                       bobyqa                   Nelder_Mead \n                    -1372.131                     -1372.131 \n                   nlminbwrap nloptwrap.NLOPT_LN_NELDERMEAD \n                    -1372.131                     -1372.131 \n    nloptwrap.NLOPT_LN_BOBYQA \n                    -1372.131 \n\n$sdcor\n                              HYBRID.(Intercept) LOC.(Intercept)\nbobyqa                                 0.6213520       0.6507697\nNelder_Mead                            0.6213521       0.6507699\nnlminbwrap                             0.6213522       0.6507695\nnloptwrap.NLOPT_LN_NELDERMEAD          0.6213541       0.6507759\nnloptwrap.NLOPT_LN_BOBYQA              0.6213595       0.6506803\n                              YEAR.(Intercept)     sigma\nbobyqa                               0.6512510 0.6788222\nNelder_Mead                          0.6512448 0.6788222\nnlminbwrap                           0.6512484 0.6788222\nnloptwrap.NLOPT_LN_NELDERMEAD        0.6511392 0.6788220\nnloptwrap.NLOPT_LN_BOBYQA            0.6515825 0.6788230\n\n$theta\n                              HYBRID.(Intercept) LOC.(Intercept)\nbobyqa                                 0.9153384       0.9586748\nNelder_Mead                            0.9153386       0.9586751\nnlminbwrap                             0.9153387       0.9586745\nnloptwrap.NLOPT_LN_NELDERMEAD          0.9153417       0.9586842\nnloptwrap.NLOPT_LN_BOBYQA              0.9153484       0.9585419\n                              YEAR.(Intercept)\nbobyqa                               0.9593838\nNelder_Mead                          0.9593747\nnlminbwrap                           0.9593800\nnloptwrap.NLOPT_LN_NELDERMEAD        0.9592193\nnloptwrap.NLOPT_LN_BOBYQA            0.9598710\n\n$times\n                              user.self sys.self elapsed user.child sys.child\nbobyqa                             0.02        0    0.03         NA        NA\nNelder_Mead                        0.03        0    0.06         NA        NA\nnlminbwrap                         0.02        0    0.03         NA        NA\nnloptwrap.NLOPT_LN_NELDERMEAD      0.03        0    0.03         NA        NA\nnloptwrap.NLOPT_LN_BOBYQA          0.03        0    0.03         NA        NA\n\n$feval\n                       bobyqa                   Nelder_Mead \n                          139                           272 \n                   nlminbwrap nloptwrap.NLOPT_LN_NELDERMEAD \n                           NA                           165 \n    nloptwrap.NLOPT_LN_BOBYQA \n                          113 \n\nattr(,\"class\")\n[1] \"summary.allFit\"\n\nblups &lt;- ranef(model)$HYBRID |&gt; \n  rownames_to_column(\"HYBRID\") |&gt; \n  rename(BLUP = '(Intercept)') |&gt; \n  arrange(BLUP)\n\nblups2 &lt;- ranef(model)$HYBRID |&gt; \n  rownames_to_column(\"HYBRID\") |&gt; \n  rename(BLUP = '(Intercept)') |&gt; \n  arrange(BLUP)\n\n# Assuming 'blups' contains HYBRID and BLUP columns from lmer\nblup_matrix &lt;- blups |&gt; \n  column_to_rownames(\"HYBRID\")\n\n# Scale the BLUPs (optional but common in clustering)\nblup_scaled &lt;- scale(blup_matrix)\n\n# Compute distance and apply hierarchical clustering\ndist_blup &lt;- dist(blup_scaled)\nclust &lt;- hclust(dist_blup, method = \"ward.D2\")\n\n# Cut the tree into 2 groups\nblups$GROUP &lt;- cutree(clust, k = 2)\n\n# Optional: sort for interpretation\nblups &lt;- blups  |&gt; \n  arrange(BLUP) |&gt; \n  mutate(cultivar = HYBRID) |&gt; \n  select(cultivar, GROUP)\n\nblups_final &lt;- left_join(blups, blups2, by = c(\"cultivar\" = \"HYBRID\"))\n\n\n# View the clustered groups\nprint(blups)\n\n          cultivar GROUP\n1     AGN 2M40PRO4     1\n2     AG 9035 PRO3     1\n3    XGEN 2102PRO3     1\n4     AGN 2M66PRO3     1\n5     AGN 2M88PRO3     1\n6     AGN 2M77PRO3     1\n7        20A38VIP3     1\n8         DGX20S01     1\n9        FS 700PWU     1\n10    XGEN 2959 RR     1\n11        DGX20T20     1\n12       P3282 VYH     1\n13 STINE 9801 VIP3     1\n14    AG 8701 PRO4     1\n15    VA 22DM PRO4     1\n16       B2401 PWU     1\n17      K7510 VIP3     1\n18        MG 408WU     1\n19      K7500 VIP3     1\n20    XGEN 3868 RR     1\n21      FS 575 PWU     1\n22    DKB 360 PRO3     1\n23    AS 1800 PRO4     1\n24       XGEN 2959     1\n25      HBR1023 EX     1\n26          SX3193     1\n27      MG 593 PWU     1\n28     STATUS VIP3     1\n29        DGX20S90     1\n30        BALU 761     1\n31       BALU 1983     1\n32        Exp B003     2\n33      BLV2223 EX     2\n34       XGEN 3668     2\n35    AGN 2M01PRO3     2\n36    SUPREMO VIP3     2\n37  XGEN 2106 PRO3     2\n38 STINESZ7634VIP3     2\n39    AGN 2M60PRO3     2\n40         PC 1203     2\n41        Exp B001     2\n42        Exp B004     2\n43       B2620 PWU     2\n44       10A40VIP3     2\n45    DKB 260 PRO4     2\n46    AS 1844 PRO4     2\n47    AG 9035 PRO4     2\n48    P3707 Leptra     2\n49        DGX20D23     2\n50           PH617     2\n51     VA 19A VIP3     2\n52        AGN 2M03     2\n53    AS 1800 PRO3     2\n54      BLV3623 EX     2\n55    AG 8480 PRO4     2\n56         IPR 216     2\n57    DKB 255 PRO4     2\n58      K9606 VIP3     2\n59    VA 16DM PRO4     2\n60          SX3517     2\n61         JM 2M60     2\n62      AGR VEREDA     2\n63        Exp B002     2\n64         IPR 127     2\n65        Exp B005     2\n66    DKB 265 PRO3     2\n67    AG 8065 PRO4     2\n68    DKB 265 PRO4     2\n69     DKB380 PRO3     2\n70       30A37 PWU     2\n71 STINE 9504 VIP3     2\n72 STINESX3279VIP3     2\n\nfig_blups &lt;- factoextra::fviz_dend(\n  clust,\n  k = 2,                                # number of groups\n  rect = FALSE,                          # draw rectangles around groups\n  rect_fill = TRUE,                     # fill the rectangles\n  rect_border = \"gray30\",              # color of the rectangle borders\n  cex = 0.8,                            # size of the label text\n  k_colors = c(\"#3A5FCD\", \"red\"),      # colors of the groups\n  color_labels_by_k = TRUE,            # color labels according to groups\n  labels_track_height = 0.8,           # height of the label track\n  horiz = TRUE,\n  main = \" \",\n  ) +  labs(y = \"Euclidean distance \") +\n  theme(axis.text.x = element_text(size = 18),\n        axis.title.x = element_text(size = 20) # increase numbers on the Y axis\n  ) +\n  theme_bw()\nprint(fig_blups)\n\n\n\n\n\n\n\n\nData preparation\n\ndata2 &lt;- left_join(data1, blups)\n\n\ndata3 &lt;- data2 |&gt; \n  group_by(estudo, tolerance_ad, cultivar, GROUP, prod_class) |&gt; \n  summarize(sev = mean(sev),\n            prod = mean(prod))\n\n\n# Fit random coefficients model: varying intercept and slope by STUDY\n\ndf &lt;- data3 |&gt; \n  mutate(GROUP = factor(GROUP),\n         STUDY = factor(estudo))  # If not already a factor\n\n\nmodel0 &lt;- lmer(prod ~ sev  + (sev | STUDY), data = df, REML = FALSE)\nmodel &lt;- lmer(prod ~ sev * GROUP + (sev | STUDY), data = df, REML = FALSE)\nanova(model0, model)\n\nData: df\nModels:\nmodel0: prod ~ sev + (sev | STUDY)\nmodel: prod ~ sev * GROUP + (sev | STUDY)\n       npar   AIC   BIC  logLik -2*log(L)  Chisq Df Pr(&gt;Chisq)    \nmodel0    6 12026 12054 -6007.1     12014                         \nmodel     8 11998 12035 -5991.2     11982 31.856  2  1.209e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\ncar::Anova(model)\n\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: prod\n             Chisq Df Pr(&gt;Chisq)    \nsev       136.0851  1  &lt; 2.2e-16 ***\nGROUP      32.9376  1  9.517e-09 ***\nsev:GROUP   0.2015  1     0.6535    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n# Random effect structure\nranef(model)\n\n$STUDY\n   (Intercept)        sev\n1  -1467.55355   18.32933\n2  -1993.00661   58.57523\n3  -1960.45476  123.71051\n4  -2713.96481   94.09337\n5     64.95362  -98.84382\n6  -1220.89903   14.14465\n7  -1736.08638  151.84767\n8  -1779.57544   24.37904\n9   -822.35491  -95.38282\n10 -1545.48937   27.51363\n11 -2505.73129   47.48575\n12 -2592.78807   46.26784\n13  2326.89337  -18.37841\n14  -675.34346  208.55023\n15 -1141.17280  214.84336\n16  2402.48300   65.45089\n17  2730.73999  -14.67321\n18  1739.61271  -51.09518\n19  3657.10972 -341.28822\n20  4582.53265 -144.17143\n21  3831.29591 -162.62002\n22   818.79950 -168.73838\n\nwith conditional variances for \"STUDY\" \n\n# Optional: extract slope and intercept per STUDY\ncoef(model)$STUDY\n\n   (Intercept)        sev   GROUP1 sev:GROUP1\n1     6262.489  -954.3187 538.5494   42.67728\n2     5737.036  -914.0728 538.5494   42.67728\n3     5769.587  -848.9375 538.5494   42.67728\n4     5016.077  -878.5546 538.5494   42.67728\n5     7794.996 -1071.4918 538.5494   42.67728\n6     6509.143  -958.5034 538.5494   42.67728\n7     5993.956  -820.8003 538.5494   42.67728\n8     5950.467  -948.2690 538.5494   42.67728\n9     6907.687 -1068.0308 538.5494   42.67728\n10    6184.553  -945.1344 538.5494   42.67728\n11    5224.311  -925.1623 538.5494   42.67728\n12    5137.254  -926.3802 538.5494   42.67728\n13   10056.935  -991.0264 538.5494   42.67728\n14    7054.699  -764.0978 538.5494   42.67728\n15    6588.869  -757.8047 538.5494   42.67728\n16   10132.525  -907.1971 538.5494   42.67728\n17   10460.782  -987.3212 538.5494   42.67728\n18    9469.655 -1023.7432 538.5494   42.67728\n19   11387.152 -1313.9362 538.5494   42.67728\n20   12312.575 -1116.8194 538.5494   42.67728\n21   11561.338 -1135.2680 538.5494   42.67728\n22    8548.842 -1141.3864 538.5494   42.67728\n\n\n\n\nCovariates\n\nSusceptibility levels used as a fixed covariate\nAdding the interaction between severity and susceptibility group did not improve the model fit, indicating that severity affects production similarly across groups.\n\n# susceptibility levels\n\nmodel_full &lt;- lmer(prod ~ sev * GROUP + (sev | STUDY), data = df, REML = FALSE)\nmodel_no_interaction &lt;- lmer(prod ~ sev + GROUP + (sev | STUDY), data = df, REML = FALSE)\nmodel_no_group &lt;- lmer(prod ~ sev + (sev | STUDY), data = df, REML = FALSE)\nanova(model_no_group, model_no_interaction, model_full)\n\nData: df\nModels:\nmodel_no_group: prod ~ sev + (sev | STUDY)\nmodel_no_interaction: prod ~ sev + GROUP + (sev | STUDY)\nmodel_full: prod ~ sev * GROUP + (sev | STUDY)\n                     npar   AIC   BIC  logLik -2*log(L)   Chisq Df Pr(&gt;Chisq)\nmodel_no_group          6 12026 12054 -6007.1     12014                      \nmodel_no_interaction    7 11996 12028 -5991.3     11982 31.6657  1  1.831e-08\nmodel_full              8 11998 12035 -5991.2     11982  0.1907  1     0.6623\n                        \nmodel_no_group          \nmodel_no_interaction ***\nmodel_full              \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nTolerance group used as covariate\nAdding the interaction between severity and tolerance group did not improve the model fit, indicating that severity affects production similarly across groups.\n\n# tolerance group\ndf2 &lt;- data1 |&gt; \n  mutate(tolerance_ad = factor(tolerance_ad),\n         estudo = factor(estudo))\n\nmodel_full &lt;- lmer(prod ~ sev * tolerance_ad + (sev | estudo), data = df2, REML = FALSE)\nmodel_no_interaction &lt;- lmer(prod ~ sev + tolerance_ad + (sev | estudo), data = df2, REML = FALSE)\nmodel_no_group &lt;- lmer(prod ~ sev + (sev | estudo), data = df2, REML = FALSE)\nanova(model_no_group, model_no_interaction, model_full)\n\nData: df2\nModels:\nmodel_no_group: prod ~ sev + (sev | estudo)\nmodel_no_interaction: prod ~ sev + tolerance_ad + (sev | estudo)\nmodel_full: prod ~ sev * tolerance_ad + (sev | estudo)\n                     npar   AIC   BIC logLik -2*log(L)   Chisq Df Pr(&gt;Chisq)\nmodel_no_group          6 20722 20753 -10355     20710                      \nmodel_no_interaction    7 20649 20684 -10317     20635 75.7620  1     &lt;2e-16\nmodel_full              8 20651 20691 -10317     20635  0.0031  1     0.9558\n                        \nmodel_no_group          \nmodel_no_interaction ***\nmodel_full              \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nFoliar spot pressure used as a moderator\nAdding the interaction between severity and foliar spot pressure did not improve the model fit, indicating that severity affects production similarly across groups.\n\n#foliar spot pressure\nmed_spots &lt;- sev_dif |&gt; \n  summarise(med_spots = median(manchas_totais, na.rm = TRUE)) |&gt; \n  pull(med_spots)\n\ndf5 &lt;- sev_dif |&gt; \n  mutate(spot_press = factor(ifelse(manchas_totais &gt; med_spots, \"alta\", \"baixa\")))\n\nmodel_full &lt;- lmer(prod ~ enfez * spot_press + (enfez | estudo), data = df5, REML = FALSE)\nmodel_no_interaction &lt;- lmer(prod ~ enfez + spot_press + (enfez | estudo), data = df5, REML = FALSE)\nmodel_no_group &lt;- lmer(prod ~ enfez + (enfez | estudo), data = df5, REML = FALSE)\nanova(model_no_group, model_no_interaction, model_full)\n\nData: df5\nModels:\nmodel_no_group: prod ~ enfez + (enfez | estudo)\nmodel_no_interaction: prod ~ enfez + spot_press + (enfez | estudo)\nmodel_full: prod ~ enfez * spot_press + (enfez | estudo)\n                     npar   AIC   BIC logLik -2*log(L)  Chisq Df Pr(&gt;Chisq)\nmodel_no_group          6 20722 20753 -10355     20710                     \nmodel_no_interaction    7 20724 20760 -10355     20710 0.1424  1     0.7059\nmodel_full              8 20726 20767 -10355     20710 0.0677  1     0.7947"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "How Much Yield Loss Is Caused by the Corn Stunt Disease Complex?",
    "section": "",
    "text": "Explore our collection of carefully documented R scripts, designed to make it easy to replicate the analyses from our study on modeling yield losses caused by the corn stunt disease complex.\nA preprint version of this work is available here."
  },
  {
    "objectID": "index.html#abstract",
    "href": "index.html#abstract",
    "title": "How Much Yield Loss Is Caused by the Corn Stunt Disease Complex?",
    "section": "Abstract",
    "text": "Abstract\nHistorically considered of secondary importance, the corn stunt disease complex, caused by mollicutes and viruses, has recently become an increasing concern in Brazil. In this study, we assessed the relationship between disease severity (1–6 ordinal scale) and corn yield (kg/ha). Data from 22 independent field trials conducted across 10 municipalities in Paraná over two seasons were analyzed. The data were combined using a mixed-effects model to estimate both the attainable yield and the yield decline rate associated with disease severity. Heterogeneity among studies was explored through the influence of four moderator variables: yield class, severity class, hybrid tolerance, and hybrid susceptibility. Only yield class significantly explained variation among studies. The estimated global attainable yield was 8,229.03 kg/ha, with a yield decline rate of −1,043 kg per unit increase in disease score. On average, each additional point on the severity scale corresponded to a -12.3% yield reduction, reaching up to -63% at the highest severity level. However, for low-yield hybrids, the model estimates a −12.6% reduction per severity point, whereas for high-yield hybrids, the reduction was −7.4% per point. These findings highlight the substantial impact of the corn stunt disease complex on yield."
  },
  {
    "objectID": "index.html#about-me",
    "href": "index.html#about-me",
    "title": "How Much Yield Loss Is Caused by the Corn Stunt Disease Complex?",
    "section": "About me",
    "text": "About me\n\n\n\nI’m Marcelo Gonçalves, a Brazilian PhD candidate in Plant Pathology (UFV). I have conducted research in the molecular and population biology of plant viruses. Nowadays, I am using modeling and remote sensing to study the epidemiology of the corn stunt complex disease, caused by viruses and mollicutes."
  },
  {
    "objectID": "index.html#contact",
    "href": "index.html#contact",
    "title": "How Much Yield Loss Is Caused by the Corn Stunt Disease Complex?",
    "section": "Contact",
    "text": "Contact\nIf you find any errors in the code or have any questions, send me an email at marcelo.h.goncalves@ufv.br or connect with me on\nGitHub |\nLinkedIn |\nInstagram |\nX (Twitter)"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "mapa2.html",
    "href": "mapa2.html",
    "title": "Modeling of yield losses caused by the corn stunt disease complex",
    "section": "",
    "text": "Dependencies\nLet’s load all the packages we will use in the map creation\n\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(rnaturalearth)\nlibrary(rnaturalearthhires)\nlibrary(ggrepel)\nlibrary(ggspatial)\nlibrary(cowplot)\n\n\n\nCoordinates\nCreate the data frame with the studies and coordinates\n\ndados &lt;- tribble(\n  ~Trial, ~Municipality, ~Year, ~Latitude, ~Longitude,\n   1, \"Cambará\", 2022, -23.0466, -50.0750,\n   2, \"Cambará\", 2022, -23.0466, -50.0750,\n   3, \"Campo Mourão\", 2022, -24.0469, -52.3780,\n   4, \"Campo Mourão\", 2022, -24.0469, -52.3780,\n   5, \"Londrina\", 2022, -23.3045, -51.1696,\n   6, \"Londrina\", 2022, -23.3045, -51.1696,\n   7, \"Palotina\", 2022, -24.2836, -53.8406,\n   8, \"Palotina\", 2022, -24.2836, -53.8406,\n   9, \"Santa Helena\", 2022, -24.8583, -54.3366,\n  10, \"Santa Helena\", 2022, -24.8583, -54.3366,\n  11, \"Santa Tereza do Oeste\", 2022, -25.0540, -53.6275,\n  12, \"Santa Tereza do Oeste\", 2022, -25.0540, -53.6275,\n  13, \"Londrina\", 2023, -23.3045, -51.1696,\n  14, \"Primeiro de Maio\", 2023, -22.8515, -51.0290,\n  15, \"Cambará\", 2023, -23.0466, -50.0750,\n  16, \"Sabáudia\", 2023, -23.3152, -51.5554,\n  17, \"Ibiporã\", 2023, -23.2659, -51.0520,\n  18, \"Campo Mourão\", 2023, -24.0469, -52.3780,\n  19, \"Palotina\", 2023, -24.2836, -53.8406,\n  20, \"Medianeira\", 2023, -25.2971, -54.0942\n)\n\n\nBRA &lt;- ne_states(country = \"Brazil\",\n                 returnclass = \"sf\")\nARG &lt;- ne_states(country = \"Argentina\",\n                 returnclass = \"sf\")\nPRG &lt;- ne_states(country = \"Paraguay\",\n                 returnclass = \"sf\")\n\n# Now extract the state\n# Use unique(BRA$name) to see the names of the states\n\nunique(BRA$name)\n\n [1] \"Rio Grande do Sul\"   \"Roraima\"             \"Pará\"               \n [4] \"Acre\"                \"Amapá\"               \"Mato Grosso do Sul\" \n [7] \"Paraná\"              \"Santa Catarina\"      \"Amazonas\"           \n[10] \"Rondônia\"            \"Mato Grosso\"         \"Maranhão\"           \n[13] \"Piauí\"               \"Ceará\"               \"Rio Grande do Norte\"\n[16] \"Paraíba\"             \"Pernambuco\"          \"Alagoas\"            \n[19] \"Sergipe\"             \"Bahia\"               \"Espírito Santo\"     \n[22] \"Rio de Janeiro\"      \"São Paulo\"           \"Goiás\"              \n[25] \"Distrito Federal\"    \"Minas Gerais\"        \"Tocantins\"          \n\nPR &lt;- BRA[BRA$name_en == \"Paraná\", ]\n\n# Group by location and count the number of studies\nresumo_locais &lt;- dados %&gt;%\n  group_by(Municipality, Latitude, Longitude) %&gt;%\n  summarise(n = n(), .groups = \"drop\")\n\nfig1 &lt;- ggplot() +\n  # Brazil map in the background, with a light fill color\n  geom_sf(data = BRA, fill = \"gray90\", color = \"gray60\") +\n  geom_sf(data = ARG, fill = \"gray90\", color = \"gray60\") +\n  geom_sf(data = PRG, fill = \"gray90\", color = \"gray60\") +\n  \n  # Paraná overlaid in white\n  geom_sf(data = PR, fill = \"white\", color = \"black\", linewidth = 0.4) +\n  \n  # Points\n  geom_point(data = resumo_locais,\n             aes(x = Longitude, y = Latitude, size = n),\n             color = \"#3A5FCD\", alpha = 0.7) +\n  \n  # label\n  geom_label_repel(data = resumo_locais,\n                   aes(x = Longitude, y = Latitude, label = Municipality),\n                   size = 3, fontface = \"bold\",\n                   max.overlaps = Inf,\n                   fill = \"white\",\n                   color = \"black\",\n                   label.size = 0.5,\n                   segment.size = 0.3,\n                   point.padding = 0.3,\n                   force = 5,\n                   nudge_y = 0.25) +\n  \n  # Size legend\n  scale_size_continuous(\n    name = \"No. of trials\",\n    range = c(3, 8),\n    breaks = c(1, 2, 3),\n    guide = guide_legend(override.aes = list(alpha = 1))\n  ) +\n  \n  # Visualization limits\n  coord_sf(xlim = c(-55, -48), ylim = c(-27, -22), expand = FALSE) +\n   annotation_north_arrow(location = \"bl\", which_north = \"true\",\n                         style = north_arrow_fancy_orienteering)+\n  \n  theme_bw()\n\nfig1\n\n\n\n\n\n\n\n\n\n\n\n\n# Map of Brazil with Paraná highlighted\ninset_map &lt;- ggplot() +\n  geom_sf(data = BRA, fill = \"gray90\", color = \"gray80\") +\n  geom_sf(data = PR, fill = \"white\", color = \"black\", linewidth = 0.3) +\n  coord_sf(xlim = c(-75, -34), ylim = c(-34, 6), expand = FALSE) +\n  theme_void() +\n  theme(panel.border = element_rect(color = \"black\", fill = NA, linewidth = 0.8))\n\ninset_map\n\n\n\n\n\n\n\n\n\nfinal_map &lt;- ggdraw() +\n  draw_plot(fig1) +  # Main map\n  draw_plot(inset_map, \n            x = 0.77, y = 0.70,    # Top-left corner position\n            width = 0.24, height = 0.24)  # inset size\n\nfinal_map"
  }
]